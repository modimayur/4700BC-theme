{{ 'testimonial-mediaslider-swiper.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.5 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.5 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}

<div class="section-{{ section.id }}-padding gradient color-{{ section.settings.color_scheme }}">
  <div class="{% if section.settings.full_width %}full-page-width{% else %}page-width{% endif %}">
    {% if section.settings.text != blank or section.settings.heading != blank %}
      <div class="title-wrapper--no-top-margin center">
        {% if section.settings.text != blank %}
          <p class="subheading">{{ section.settings.text }}</p>
        {% endif %}
        {% if section.settings.heading != blank %}
          <h2 class="title inline-richtext hxxl">{{ section.settings.heading }}</h2>
        {% endif %}
      </div>
    {% endif %}

    <div class="testimonial-mediaslider-swiper">
      <div class="swiper">
        <div class="swiper-wrapper">
          {% for block in section.blocks %}
            <div class="swiper-slide blockquote-slide {% if block.settings.video != blank %} video-slide video-slide-{{ section.id }}{% endif %}">
              {% if block.settings.video != blank %}
                <div class="blockquote-wrapper">
                  {% assign poster = block.settings.image | image_url: width: section.settings.image.width %}

                  {{
                    block.settings.video
                    | video_tag:
                      image_size: 285,
                      autoplay: false,
                      loop: true,
                      muted: false,
                      controls: false,
                      class: 'slider-slide-video',
                      data-index: forloop.index,
                      poster: poster
                  }}
                  <div class="vss-play-button vss-play-button-{{ section.id }}">
                    <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="24" cy="24.6108" r="24" fill="black" fill-opacity="0.32"/>
                      <path d="M34 24.6108C34.0005 24.8459 33.9451 25.0771 33.8392 25.2819C33.7332 25.4868 33.5804 25.6584 33.3954 25.7799L21.9345 33.4071C21.7413 33.5358 21.52 33.606 21.2935 33.6106C21.0669 33.6152 20.8434 33.5539 20.6459 33.433C20.4503 33.314 20.2874 33.1405 20.1739 32.9304C20.0603 32.7202 20.0003 32.4809 20 32.2371V16.9846C20.0003 16.7408 20.0603 16.5015 20.1739 16.2913C20.2874 16.0811 20.4503 15.9076 20.6459 15.7887C20.8434 15.6678 21.0669 15.6065 21.2935 15.6111C21.52 15.6156 21.7413 15.6859 21.9345 15.8146L33.3954 23.4418C33.5804 23.5633 33.7332 23.7349 33.8392 23.9397C33.9451 24.1446 34.0005 24.3758 34 24.6108Z" fill="white"/>
                    </svg>
                  </div>
                </div>
              {% elsif block.settings.image != blank %}
                <div class="blockquote-wrapper">
                  {{
                    block.settings.image
                    | image_url: width: section.settings.image.width
                    | image_tag: loading: 'lazy', class: 'blockquote-banner'
                  }}
                </div>
              {% endif %}
              <div class="blockquote-info">
                <div class="auther_img_wrap">
                  {% if block.settings.auther_img != blank %}
                    <div class="auther_img">
                      {{
                        block.settings.auther_img
                        | image_url: width: 56, height: 56
                        | image_tag: loading: 'lazy', class: 'mobile-size-fix'
                      }}
                    </div>
                  {% endif %}
                  {% if block.settings.name %}
                    <h3 class="h3">{{ block.settings.name }}</h3>
                  {% endif %}
                  <div class="stars-review">
                    {% assign ratingaraay = block.settings.ratting %}
                    {% for i in (1..ratingaraay) %}
                      <div class="star-icon">
                        <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M10.0308 4.25515C10.2142 3.89792 10.3059 3.71931 10.4303 3.66224C10.5386 3.61259 10.6645 3.61259 10.7728 3.66224C10.8973 3.71931 10.989 3.89792 11.1724 4.25515L12.9123 7.64428C12.9664 7.74974 12.9935 7.80248 13.0331 7.84342C13.0681 7.87967 13.1101 7.90904 13.1568 7.9299C13.2095 7.95347 13.27 7.96197 13.391 7.97898L17.2829 8.52594C17.6928 8.58353 17.8977 8.61233 17.9925 8.70858C18.075 8.79232 18.1138 8.90738 18.0981 9.02174C18.0801 9.15318 17.9317 9.29211 17.635 9.56998L14.8199 12.2064C14.7321 12.2885 14.6882 12.3296 14.6599 12.3785C14.6348 12.4218 14.6188 12.4694 14.6125 12.5186C14.6055 12.5741 14.6159 12.6322 14.6366 12.7483L15.3009 16.472C15.3709 16.8648 15.4059 17.0612 15.3401 17.1777C15.2828 17.2791 15.181 17.3502 15.063 17.3712C14.9274 17.3954 14.744 17.3027 14.3772 17.1172L10.8978 15.3579C10.7894 15.3031 10.7352 15.2757 10.6781 15.2649C10.6276 15.2554 10.5756 15.2554 10.525 15.2649C10.4679 15.2757 10.4137 15.3031 10.3053 15.3579L6.82595 17.1172C6.45913 17.3027 6.27572 17.3954 6.1401 17.3712C6.02211 17.3502 5.92029 17.2791 5.86301 17.1777C5.79718 17.0612 5.83221 16.8648 5.90227 16.472L6.56652 12.7483C6.58723 12.6322 6.59758 12.5741 6.59058 12.5186C6.58438 12.4694 6.56829 12.4218 6.54322 12.3785C6.51491 12.3296 6.47103 12.2885 6.38327 12.2064L3.56811 9.56998C3.2714 9.29211 3.12304 9.15318 3.10499 9.02174C3.08928 8.90738 3.12809 8.79232 3.2106 8.70858C3.30543 8.61233 3.51035 8.58353 3.92019 8.52594L7.81211 7.97898C7.93315 7.96197 7.99366 7.95347 8.04637 7.9299C8.09303 7.90904 8.13504 7.87967 8.17007 7.84342C8.20963 7.80248 8.23671 7.74974 8.29085 7.64428L10.0308 4.25515Z" fill="currentColor" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </div>
                    {% endfor %}
                  </div>
                </div>
                {%- if block.settings.description != blank -%}
                  <div class="rte">
                    {{ block.settings.description }}
                  </div>
                {%- endif -%}
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
      <div class="swiper-navigation-buttons">
        <div id="prev--{{ section.id }}" class="swiper-navigation-button swiper-button-prev">
          <span>
            <svg
              aria-hidden="true"
              focusable="false"
              class="icon icon-caret"
              width="25"
              height="25"
              viewBox="0 0 25 25"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M14.6016 17.5L9.60156 12.5L14.6016 7.5" stroke="#DBDBDB" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
        </div>
        <div id="next--{{ section.id }}" class="swiper-navigation-button swiper-button-next">
          <span>
            <svg
              aria-hidden="true"
              focusable="false"
              class="icon icon-caret"
              width="25"
              height="25"
              viewBox="0 0 25 25"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M14.6016 17.5L9.60156 12.5L14.6016 7.5" stroke="#DBDBDB" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    new Swiper('.testimonial-mediaslider-swiper .swiper', {
      slidesPerView: 1.5,
      spaceBetween: 16,
      autoplay: {
        delay: 2500,
        disableOnInteraction: false,
      },
      breakpoints: {
        640: {
          slidesPerView: 2,
        },
        1024: {
          slidesPerView: 3,
          spaceBetween: 20,
        },
        1600: {
          slidesPerView: 4,
        },
      },
      navigation: {
        nextEl: '.section-testimonial-mediaslider .swiper-button-next',
        prevEl: '.section-testimonial-mediaslider .swiper-button-prev',
      },
    });

    if (document.querySelectorAll('.vss-play-button-{{ section.id }}')) {
      document.querySelectorAll('.vss-play-button-{{ section.id }}').forEach((button) => {
        button.addEventListener('click', (e) => {
          let video = button.closest('.swiper-slide').querySelector('video');
          videoControl(video);
        });
      });
    }

    if (document.querySelectorAll('.video-slide-{{ section.id }} .slider-slide-video')) {
      document.querySelectorAll('.video-slide-{{ section.id }} .slider-slide-video').forEach((video) => {
        video.addEventListener('click', (e) => {
          videoControl(video);
        });
      });
    }

    function videoControl(video) {
      document.querySelectorAll('.video-slide-{{ section.id }} .slider-slide-video').forEach((v) => {
        if (v.dataset.index === video.dataset.index) {
          if (v.paused) {
            v.play();
            v.classList.add('playing');
          } else {
            v.pause();
            v.classList.remove('playing');
          }
        } else {
          v.pause();
          v.classList.remove('playing');
        }
      });
    }
  });
</script>
{% schema %}
{
  "name": "Testimonial Media Slider",
  "class": "section-testimonial-mediaslider",
  "tag": "section",
  "settings": [
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full Width Section",
      "default": false
    },
    {
      "type": "textarea",
      "id": "heading",
      "label": "heading",
      "default": "Discover the Secret to Perfect Skin"
    },
    {
      "type": "inline_richtext",
      "id": "text",
      "label": "text"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    },
    {
      "type": "text",
      "id": "button_label",
      "default": "t:sections.image-with-text.blocks.button.settings.button_label.default",
      "label": "t:sections.image-with-text.blocks.button.settings.button_label.label",
      "info": "t:sections.image-with-text.blocks.button.settings.button_label.info"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "t:sections.image-with-text.blocks.button.settings.button_link.label"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Vector Image"
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 180,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 180,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "blockquote",
      "name": "Blockquote",
      "settings": [
        {
          "type": "header",
          "content": "Media",
          "info": "Both images and videos can be added here, but video will take precedence."
        },
        {
          "type": "video",
          "id": "video",
          "label": "Video"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "image_picker",
          "id": "auther_img",
          "label": "Auther Image"
        },
        {
          "type": "text",
          "id": "name",
          "label": "Name"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "t:sections.featured-collection.settings.description.label"
        },
        {
          "type": "range",
          "id": "ratting",
          "label": "Review stars",
          "min": 0,
          "max": 5,
          "default": 5,
          "step": 1
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonial Media Slider"
    }
  ]
}
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}
