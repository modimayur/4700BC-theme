{%- for media_obj in product.metafields.custom.media_under_description.value -%}
  
    <div class="media-block">
      {% case media_obj.media_type  %}
        {% when 'image'  %}
          {{ 'section-image-banner.css' | asset_url | stylesheet_tag }}
          {{ 'section-custom-image-banner.css' | asset_url | stylesheet_tag }}

          {%- style -%}
            @media screen and (max-width: 749px) {
              #Banner-{{ media_obj.id }}::before,
              #Banner-{{ media_obj.id }} .banner__media::before,
              #Banner-{{ media_obj.id }}:not(.banner--mobile-bottom) .banner__content::before {
                padding-bottom: {{ 1 | divided_by: media_obj.aspect_ratio | times: 100 }}%;
                content: '';
                display: block;
              }
            }
      
            @media screen and (min-width: 750px) {
              #Banner-{{ media_obj.id }}::before,
              #Banner-{{ media_obj.id }} .banner__media::before {
                padding-bottom: {{ 1 | divided_by: media_obj.aspect_ratio | times: 100 }}%;
                content: '';
                display: block;
              }
            }
          {%- endstyle -%}
          
          {%- liquid
            assign full_width = '100vw'
            assign widths = '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
          
            assign full_width = '120vw'
            assign stacked_sizes = '(min-width: 750px) 60vw, 120vw'
            assign widths = '450, 660, 900, 1320, 1800, 2136, 2400, 3600, 7680'
            assign fetch_priority = 'auto'
      
            if section.index == 1
              assign fetch_priority = 'high'
            endif
          -%}
          <div id="Banner-{{ media_obj.id }}" class="banner banner--content-align-left banner--content-align-mobile-center banner--adapt banner--mobile-bottom scroll-trigger animate--fade-in scroll-trigger--design-mode"
          >
            {%- if media_obj != blank -%}
              <div class="banner__media media animate--ambient scroll-trigger animate--fade-in">
                {%- liquid
                  assign image_height = media_obj.width | divided_by: media_obj.aspect_ratio
                  assign sizes = full_width                
                -%}
                {{
                  media_obj
                  | image_url: width: 3840
                  | image_tag:
                    width: media_obj.width,
                    height: image_height,
                    class: image_class,
                    sizes: sizes,
                    widths: widths,
                    fetchpriority: fetch_priority
                }}
              </div>
            {%- endif -%}
          </div>
        {% when 'video'  %}
          {{ 'video-section.css' | asset_url | stylesheet_tag }}
          {{ 'component-deferred-media.css' | asset_url | stylesheet_tag }}

          {%- liquid
            assign video_id = media_obj.id | default: section.settings.video_url.id
            assign video_alt = media_obj.alt | default: section.settings.description
            assign alt = 'sections.video.load_video' | t: description: video_alt | escape
            assign poster = media_obj.preview_image | default: section.settings.cover_image

            assign ratio_diff = media_obj.aspect_ratio | minus: poster.aspect_ratio | abs
            if ratio_diff < 0.01 and ratio_diff > 0
            assign fix_ratio = true
            endif
            
          -%}

          {%- capture sizes -%}
            (min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 100 }}px, (min-width: 750px)
            calc(100vw - 10rem), 100vw
          {%- endcapture -%}

          <div class="video-section isolate">
            <deferred-media
              class="video-section__media deferred-media gradient global-media-settings{% if fix_ratio %} media-fit-cover{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
              data-media-id="{{ video_id }}"
              {% if poster != null %}
                style="--ratio-percent: {{ 1 | divided_by: poster.aspect_ratio | times: 100 }}%;"
              {% endif %}
            >
              <button
                id="Deferred-Poster-Modal-{{ video_id }}"
                class="video-section__poster media deferred-media__poster media--landscape"
                type="button"
                aria-label="{{ alt }}"
              >
                {%- if poster != null -%}
                  {{
                    poster
                    | image_url: width: 3840
                    | image_tag: sizes: sizes, widths: '375, 750, 1100, 1500, 1780, 2000, 3000, 3840', alt: alt
                  }}
                {%- else -%}
                  {{ 'hero-apparel-3' | placeholder_svg_tag: 'placeholder-svg placeholder' }}
                {%- endif -%}
                <span class="deferred-media__poster-button motion-reduce">
                  {%- render 'icon-play' -%}
                </span>
              </button>
              <template>
                {{
                  media_obj
                  | video_tag:
                    image_size: '1100x',
                    autoplay: true,
                    loop: false,
                    controls: true,
                    muted: false
                }}
              </template>
            </deferred-media>
          </div>
        {% endcase %}
    </div>
  
{%- endfor -%}